# GRUB 2 man page

$ man 8 grub2-mkconfig
SEE ALSO
       info grub
    
$ info grub
6.1 Simple configuration handling
=================================

The program 'grub2-mkconfig' (*note Invoking grub2-mkconfig::) generates
'grub.cfg' files suitable for most cases.  It is suitable for use when
upgrading a distribution, and will discover available kernels and
attempt to generate menu entries for them.

   'grub2-mkconfig' does have some limitations.  While adding extra
custom menu entries to the end of the list can be done by editing
'/etc/grub.d/40_custom' or creating '/boot/grub2/custom.cfg', changing
the order of menu entries or changing their titles may require making
complex changes to shell scripts stored in '/etc/grub.d/'.  This may be
improved in the future.  In the meantime, those who feel that it would
be easier to write 'grub.cfg' directly are encouraged to do so (*note
Booting::, and *note Shell-like scripting::), and to disable any system
provided by their distribution to automatically run 'grub2-mkconfig'.

   The file '/etc/default/grub' controls the operation of
'grub2-mkconfig'.  It is sourced by a shell script, and so must be valid
POSIX shell input; normally, it will just be a sequence of 'KEY=value'
lines, but if the value contains spaces or other special characters then
it must be quoted.  For example:

     GRUB_TERMINAL_INPUT="console serial"

/etc/default/grub: define the behaviors of grub2, such as boot arguments, timeout
/etc/grub.d/: customized version of /etc/default/grub, it contains many shell scripts, such as:01_users
/boot/grub2/grub.cfg: the config file generated by the script based on the settings of /etc/default/grub

/boot/grub2/: These are automatically generated from GRUB2 config file. Don't modify them.

in a BIOS system: the config file is under /boot/grub2/grub.cfg
in a UEFI system: the config file is under /boot/efi/EFI/redhat

[root@localhost lisa]# cat /etc/default/grub 
GRUB_TIMEOUT=5
GRUB_DISTRIBUTOR="$(sed 's, release .*$,,g' /etc/system-release)"
GRUB_DEFAULT=saved
GRUB_DISABLE_SUBMENU=true
GRUB_TERMINAL_OUTPUT="console"
GRUB_CMDLINE_LINUX="crashkernel=auto resume=UUID=ce900ef4-22cc-4e07-9924-9308c82f6b65 rd.lvm.lv=cl/sda2 rhgb quiet"
GRUB_DISABLE_RECOVERY="true"
GRUB_ENABLE_BLSCFG=true

[root@localhost grub.d]# cat 01_users
#!/bin/sh -e
cat << EOF
if [ -f \${prefix}/user.cfg ]; then
  source \${prefix}/user.cfg
  if [ -n "\${GRUB2_PASSWORD}" ]; then
    set superusers="root"
    export superusers
    password_pbkdf2 root \${GRUB2_PASSWORD}
  fi
fi
EOF


[root@localhost ~]# cd /boot/grub2
[root@localhost grub2]# ls
device.map  fonts  grub.cfg  grubenv  i386-pc
[root@localhost grub2]# cat grub.cfg 


[root@localhost centos]# pwd
/boot/efi/EFI/centos
[root@localhost centos]# ls

# modify GRUB config file
# Change boot arguments: remove rhgb quiet. Debug info will show up
# Change boot menu timer
[root@localhost grub.d]# vi /etc/default/grub
[root@localhost grub.d]# cat /etc/default/grub 
GRUB_TIMEOUT=10
GRUB_DISTRIBUTOR="$(sed 's, release .*$,,g' /etc/system-release)"
GRUB_DEFAULT=saved
GRUB_DISABLE_SUBMENU=true
GRUB_TERMINAL_OUTPUT="console"
GRUB_CMDLINE_LINUX="crashkernel=auto resume=UUID=ce900ef4-22cc-4e07-9924-9308c82f6b65 rd.lvm.lv=cl/sda2"
GRUB_DISABLE_RECOVERY="true"
GRUB_ENABLE_BLSCFG=true

# push GRUB config change to boot config file
[root@localhost grub.d]# grub2-mkconfig -o /boot/grub2/grub.cfg
Generating grub configuration file ...
done

# where to find the boot parameters?
[root@localhost grub.d]# man 7 bootparam
BOOTPARAM(7)                            Linux Programmer's Manual                           BOOTPARAM(7)

NAME
       bootparam - introduction to boot time parameters of the Linux kernel